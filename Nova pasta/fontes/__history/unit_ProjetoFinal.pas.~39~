unit unit_ProjetoFinal;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Menus, Unit_ControleFuncionario,
   Unit_Controle,Unit_ControlePedido,Unit_ControleVeiculo,Unit_ControleEdits;

type
  TFrm_Principal = class(TForm)
    MainMenu1: TMainMenu;
    Cadastros1: TMenuItem;
    Pedidos1: TMenuItem;
    Funcionario1: TMenuItem;
    Cliente1: TMenuItem;
    Veiculo1: TMenuItem;
    Pendente1: TMenuItem;
    Aprovados1: TMenuItem;
    Pedido1: TMenuItem;
    Consultas1: TMenuItem;
    Consultas2: TMenuItem;
    Carga1: TMenuItem;
    ConsultarClientes: TMenuItem;
    procedure Cliente1Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure Funcionario1Click(Sender: TObject);
    procedure Veiculo1Click(Sender: TObject);
    procedure Pedido1Click(Sender: TObject);
    procedure FormActivate(Sender: TObject);
    procedure Carga1Click(Sender: TObject);
    procedure Consultas2Click(Sender: TObject);
    procedure ConsultarClientesClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    Controle:TControle;
    ControleFuncionario:TControle_Funcionario;
    ControleVeiculo:TControle_Veiculo;
    ControlePedido:TControle_Pedido;
    ControleEdit:TControleEdit;

    procedure clearMemory;
  end;

var
  Frm_Principal: TFrm_Principal;

implementation

{$R *.dfm}

 uses Unit_Dados, Form_CadPessoa, Objeto_CadFuncionario, Form_CadPedido,
  Form_CadFuncionario, Form_CadVeiculos, Form_Consulta, Form_CadEntrega;


procedure TFrm_Principal.Carga1Click(Sender: TObject);
begin
   ControlePedido.getCadEntrega;
end;

procedure TFrm_Principal.clearMemory;
var
clear : THandle;
begin
    try
     clear := OpenProcess(PROCESS_ALL_ACCESS, false, GetCurrentProcessId);
     SetProcessWorkingSetSize(clear, $ffffffff, $ffffffff);
     CloseHandle(clear);
    Except

    end;

end;

procedure TFrm_Principal.Cliente1Click(Sender: TObject);
begin
    Controle.getCadPessoa;
end;

procedure TFrm_Principal.ConsultarClientesClick(Sender: TObject);
begin
      ControleFuncionario.consultarPessoas;
      
end;

procedure TFrm_Principal.Consultas2Click(Sender: TObject);
begin
    ControleEdit.getEdits;
end;

procedure TFrm_Principal.FormActivate(Sender: TObject);
begin
    self.clearMemory;
    FreeAndNil(frm_Pedido);
    FreeAndNil(frm_Consulta);
    FreeAndNil(frm_Funcionario);
    FreeAndNil(frm_Cliente);
    FreeAndNil(frm_Veiculos);
    FreeAndNil(frm_carga);

end;

procedure TFrm_Principal.FormCreate(Sender: TObject);
begin
    Controle := TControle.Create;
end;

procedure TFrm_Principal.FormDestroy(Sender: TObject);
begin
    Controle.Free;
end;

procedure TFrm_Principal.Funcionario1Click(Sender: TObject);
begin
    ControleFuncionario.getCadFuncionario;
end;

procedure TFrm_Principal.Pedido1Click(Sender: TObject);
begin
   ControlePedido.getCadPedido;
end;

procedure TFrm_Principal.Veiculo1Click(Sender: TObject);
begin
    ControleVeiculo.getCadVeiculo;
end;

end.
